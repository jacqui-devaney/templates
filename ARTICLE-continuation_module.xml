<jpml id="ARTICLE-continuation_module">
	<style src="GLOBAL-stylesheet.ejs"/>
	<style src="GLOBAL_MODULES-stylesheet.ejs" />
	<style src="GRID-stylesheet.ejs" />
	<style src="ARTICLE-stylesheet.ejs" />
	<style src="ADVERTISING-stylesheet.ejs" />
	<style src="MEDIA-stylesheet.ejs" />
	<style>{
		jpml:{
			background-color: =options.background_color
		}
	}</style>
	<style>{

		$join: [
		{#body_container : {
			top: 1,
			min-height:200
		}},
		{.article_body: {
			column-gutter: 20,
			layout-grid-line: {$multiply: [20, =view.zoomlevel]},
			layout-grid-line-offset: 1
		}},
		{#body_continuation: {
			content: from-flow(article_body),
			flow: article_body
		}},
		{if: =portrait, then: {
			#media: {
				top: 0,
				left:{if: =media.width, less-than: 720, then: 0, else: {if: =media.width, more-than: 968, then: 0, else: 0}},
				width: {$switch: [
					{if: =media.width, less-than: 720, then: 236},
					{if: =media.width, more-than: 968, then: 484},
					236
				]}
			}
	}, else: {
			#media: {
				top: 0,
				left:{if: =media.width, less-than: 720, then: 248, else: {if: =media.width, more-than: 968, then: 248, else: 248}},
				width: {$switch: [
					{if: =media.width, less-than: 720, then: 236},
					{if: =media.width, more-than: 968, then: 484},
					236
				]}
			}
        }}
		]
    }</style>
    <!--
		#body_container makes one pixel of space so that #lastpage_ad_container
		can lay out if .article_body doesn't overflow and doesn't render more than
		one column of text.
	-->
	<box id="body_container">
		<box id="article_advertisement">
			<box id="skyscraper_ad" class="ad-skyscraper" embed="advertisement" />
		</box>
		<box id="media">
    		<p id="media_title"><mark id="mark_media_title"/></p>
            <panel id="media_vr_header">
                <p id="media_vr_header_left"><mark id="mark_media_vr_header_left"/></p>
                <p id="media_vr_header_right"><mark id="mark_media_vr_header_right"/></p>
            </panel>
            <box id="media_asset" embed="media"/>
    		<p id="media_vr_footer"><mark id="mark_media_vr_footer"/></p>
            <p id="media_caption"><mark id="mark_caption" /></p>
            <p id="media_vr_link"><a href="http://wsj.com/virtual-reality"><mark id="mark_media_vr_link"/></a></p>
		</box>
		<panel class="article_body">
			<panel id="body_continuation" embed="body"/>
		</panel>
	</box>
	<!--
		Only appears if less than one column of text rendered into .article_body and
		the page has no media. This is effectively #article_advertisement but that
		identifier cannot be reused since ad frequency logic may have already chosen
		to show an ad on this page, versus showing one due to layout results.

		Hide this element if this page is already showing #article_advertisement so
		it doesn't have ad on top of ad, or if there's no media on the page.
	-->
	<box id="lastpage_ad_container">
		<box id="skyscraper_ad" class="ad-skyscraper" embed="advertisement" />
	</box>
</jpml>
