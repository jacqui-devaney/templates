{
    $join: [
		=$,
		{
			portrait: { if: =view.width, less-than: =view.height },
			landscape: { if: =view.width, more-than: =view.height },

			scale: {
				width: { if: =view.width, more-than: 480, then: {
					if: =view.width,
					less-than: =view.height,
					then: { $divide: [=view.width, 768] },
					else: { $divide: [=view.width, 1024] }
				}, else: 1},
				height: { if: =view.width, more-than: 480, then: {
					if: =view.width,
					less-than: =view.height,
					then: { $divide: [=view.height, 1024] },
					else: { $divide: [=view.height, 768] }
				}, else: 1},

				phone: { if-any: [=display.width.compact, =display.width.regular], then: =display.width.compact, else:
					{ if: =app.idiom, equals: "phone", then: true, else: false }
				},

				tablet: { if-any: [=display.width.compact, =display.width.regular], then: =display.width.regular, else:
					{ if: =app.idiom, equals: "tablet", then: true, else: false }
				},

				rail: { if-all: [
					{ if: =app.idiom, equals: "tablet", then: true, else: false },
					=display.width.compact,
					=display.height.regular
				], then: true, else: false},

				old_phone: { if: =app.idiom, equals: "phone", then:true, else:false },
				old_tablet: { if: =app.idiom, equals: "tablet" }
			},


			justify: "left",

			media: {
				if: =page.mediaindex,
				at-least: 0,
				then: {
					width: {if: =page.hasmedia, then: "=article.media[page.mediaindex].width", else:0} ,
					height: {if: =page.hasmedia, then: "=article.media[page.mediaindex].height", else:0} ,
					aspect: {if: =page.hasmedia, then: {$divide:["=article.media[page.mediaindex].width", "=article.media[page.mediaindex].height"]}, else:0},
					caption: {if: =page.hasmedia, then: "=article.media[page.mediaindex].caption", else:""},
					credit: {if: =page.hasmedia, then: "=article.media[page.mediaindex].credit", else:""},
					filename: {if: =page.hasmedia, then: "=article.media[page.mediaindex].filename", else:""}
				},
				else: {
					width: {if: =page.hasmedia, then: "=article.media[page.number].width", else:0} ,
					height: {if: =page.hasmedia, then: "=article.media[page.number].height", else:0} ,
					aspect: {if: =page.hasmedia, then: {$divide:["=article.media[page.number].width", "=article.media[page.number].height"]}, else:0},
					caption: {if: =page.hasmedia, then: "=article.media[page.number].caption", else:""},
					credit: {if: =page.hasmedia, then: "=article.media[page.number].credit", else:""},
					filename: {if: =page.hasmedia, then: "=article.media[page.number].filename", else:""}
				}
			},

			text: {
				indent: 14,
				overflow: "..."
			},

			color: {
				tint: { if-all: [
					{ if: =app.idiom, equals: "tablet" },
					{ if: =issue.type, equals: "NOW" }
				], then: "#E9F5FE" },
                articleReadColor: #777777
			},

			size: {
				rail_height_with_image: 134,
				rail_height_without_image: 104,
				continuation_height_normal: 90,
                continuation_height_large: 288,
				continuation_height_strap: 226
			},

            footer_tips: [
                "You can play today's WSJ Crossword by choosing it from the navigation sidebar.",
                "The WSJ app contains a week of enhanced daily editions.",
                "You can move the WSJ icon from the newsstand folder to your home screen.",
                "You can read the Latest News by tapping on the red Latest News banner.",
                "Your WSJ app supports virtual reality video. Look for a special moving icon.",
                "Your WSJ app supports Handoff so you can read seamlessly between iOS devices.",
                "You can save space by changing the download rules in your settings.",
                "You can share and save articles by swiping left on them in the navigation sidebar.",
                "You can find WSJ articles by tapping the magnifying glass in the upper-right corner."
            ],

            footer_tip: {$random: [10]},

			ad: {
				prefix: { $join: [
					{ $switch: [
						{ if: =device.model, starts-with: iPad, then: ipad },
						{ if: =device.model, starts-with: iPhone, then: iphone },
						{ if: =device.model, starts-with: iPod, then: iphone },
						{ if: =device.platform, equals: Android, then: honeycomb },
						"default"
					] },
                    ".",
                    { $switch: [ =issue.edition,
                      { if: =article.headline, ends-with: "\u200a", then: "asia" },
                      { if: =article.headline, ends-with: "\u2009", then: "europe" },
                    "us"] },
                    ".wsj.app/",
					{ $switch: [
						{ if: =page.section, equals: FRONT_SECTION, then:
							{ if: =article.frompage, equals: 1, then: frontpage, else: front }
						},
						{ if: =page.section, equals: OPINION, then: opinion },
						{ if: =page.section, equals: MARKETPLACE, then: marketplace },
                        { if: =page.section, equals: BUSINESS_AND_TECH, then: marketplace },
						{ if: =page.section, equals: MONEY_AND_INVESTING, then: money },
						{ if: =page.section, equals: WEEKEND_JOURNAL, then: weekendjournal },
						{ if: =page.section, equals: FRIDAY_JOURNAL, then: fridayjournal },
						{ if: =page.section, equals: ARENA, then: arena },
						{ if: =page.section, equals: PERSONAL_JOURNAL, then: personaljournal },
						{ if: =page.section, equals: JOURNAL_REPORT, then: journalreport },
						{ if: =page.section, equals: WHATS_NEWS, then: whatsnews },
						{ if: =page.section, equals: NEW_YORK, then: greaterny },
						{ if: =page.section, equals: BUSINESS_AND_FINANCE, then: businessfinance },
						{ if: =page.section, equals: REVIEW, then: review },
						{ if: =page.section, equals: OFF_DUTY, then: offduty },
						{ if: =page.section, equals: CAMPAIGN, then: campaign },
						{ if: =page.section, equals: WSJ_MAGAZINE, then: magazine },
						{ if: =page.section, equals: SPECIAL_REPORT, then: specialreport },
						{ if: =page.section, equals: SPECIAL_REPORT_TWO, then: specialreporttwo },
						{ if: =page.section, equals: EUROPE, then: europe },
						{ if: =page.section, equals: ASIA, then: asia },
						{ if: =page.section, equals: LIFE_AND_STYLE, then: lifeandstyle },
						{ if: =page.section, equals: MANSION, then: realestate },
						{ if: =page.section, equals: HONG_KONG, then: hongkong },
						{ if: =page.section, equals: DEUTSCHLAND, then: deutschland },
						{ if: =page.section, equals: ANALYSE, then: analyse },
						{ if: =page.section, equals: WIRTSCHAFT_AND_FINANZEN, then: wirtschaft },
						{ if: =page.section, equals: UNTERNEHMEN, then: unternehmen },
						{ if: =page.section, equals: INTERNATIONAL, then: international },
						{ if: =page.section, equals: TECHNOLOGIE, then: technologie },
						{ if: =page.section, equals: SEITE_EINS, then:
							{ if: =article.frompage, equals: 1, then: aufmacher, else: seiteeins }
						},
						{ if: =page.section, equals: JAPAN_AND_WORLD, then: japan },
						{ if: =page.section, equals: LIFESTYLE, then: lifestyle },
						{ if: =page.section, equals: BUSINESS_AND_MARKETS, then: businessmarkets },
						{ if: =page.section, equals: BUSINESS_AND_ECONOMY, then: businesseconomy },
						{ if: =page.section, equals: WSJ_MONEY, then: wsjmoney },
						{ if: =page.section, equals: SAVED, then: saved },
						{ if: =page.section, equals: TOP_NEWS, then: topnews },
						{ if: =page.section, equals: WORLD, then: world },
						{ if: =page.section, equals: BUSINESS, then: business },
						{ if: =page.section, equals: TECHNOLOGY, then: technology },
						{ if: =page.section, equals: TECH, then: technology },
						{ if: =page.section, equals: MARKETS, then: markets },
						{ if: =page.section, equals: LIFE_AND_CULTURE, then: lifeandculture },
						{ if: =page.section, equals: US, then: us },

						"default"
					] }
				] }
			}
		}
	]

}
