<jpml id="ARTICLE-front_module">
	<style src="GLOBAL-stylesheet.ejs"/>
	<style src="GLOBAL_MODULES-stylesheet.ejs" />
	<style src="ARTICLE-stylesheet.ejs" />
	<style>{
		jpml: {
			background-color: =options.background_color
		}
	}</style>
	<style>{
		$join: [
		{#body_container: {
            column-count: { if: =portrait, then: 3, else: 4},
            column-gutter: 12,
			flow: article_body,
			min-height: {if: =page.hasmedia, then:400, else:300},
			padding:[10, 0, 0, 0],
			layout-grid-line: {$multiply: [20, =view.zoomlevel]},
			layout-grid-line-offset: {$multiply: [20, =view.zoomlevel]}

        }},
		{.border-p:{
			layout-grid-line: 0,
			layout-grid-line-offset: 0,
			border-color: =color.tint

		}},
		{if: =portrait, then: {
			#media: {
				top: 0,
				left: {if: =media.width, less-than: 360, then: 248, else: {if: =media.width, more-than: 484, then: 248, else: 248}},
				width: {$switch: [
					{if: =media.width, less-than: 360, then: 237},
					{if: =media.width, more-than: 484, then: 485},
					237
				]},
				height: {$min: [{$max: [{$switch: [
					{if: =media.width, less-than: 360, then: {$divide: [236, =media.aspect]}},
					{if: =media.width, more-than: 484, then: {$divide: [484, =media.aspect]}},
					{$divide: [236, =media.aspect]}
				]}, {$multiply: [.25, =view.height]}]}, {$multiply: [.75, =view.height]}]},
				options: {
					id: =page.number
				},
				padding:[0, 0, {if: =page.hasmedia, then:30, else:0}, 0]
			}
        }, else: {
			#media: {
				top: 0,
				left: {if: =media.width, less-than: 360, then: 248, else: {if: =media.width, more-than: 484, then: 248, else: 248}},
				width: {$switch: [
					{if: =media.width, less-than: 360, then: 236},
					{if: =media.width, more-than: 484, then: 484},
					236
				]},
				height: {$min: [{$max: [{$switch: [
					{if: =media.width, less-than: 360, then: {$divide: [236, =media.aspect]}},
					{if: =media.width, more-than: 484, then: {$divide: [484, =media.aspect]}},
					{$divide: [236, =media.aspect]}
				]}, {$multiply: [.25, =view.height]}]}, {$multiply: [.75, =view.height]}]},
				options: {
					id: =page.number
				},
				padding:[0, 0, {if: =page.hasmedia, then:30, else:0}, 0]

			}
        }}
		]
    }</style>
    <panel id="header_top">
        <p class="article_headline"><span embed="headline"/></p>
		<h2 class="article_subhed" embed="subhed" />
	</panel>

	<panel id="body_container">
		<box id="media" embed="media" />
		<p class="module_flashline" embed="flashline"/>
    	<p class="byline" embed="byline"/>
		<p class="border-p"><mark class="border-mark"/></p>
		<panel class="article_body" embed="body"/>
	</panel>
</jpml>
